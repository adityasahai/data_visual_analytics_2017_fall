After reading the file, I filter out all weights below 5 (line: 22) and create two dataframes (23 & 24), one grouped by source and one grouped by target, each having sums of weights. I create a new table by joining the outgoing dataframe and incoming dataframe where source id = target id and adding a column called "diff" which has the difference of weights between incoming and outgoing columns of each table respectively (line: 25). I select the "source" column and the "diff" column from the new dataframe created in line 25 and store it in a new dataframe in lin 26. Line 27 saves the new dataframe to an output file.